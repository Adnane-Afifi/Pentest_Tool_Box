
# Booteres
Booteres est un projet développé dans le cadre d'un master en cybersécurité à l'École Sup de Vinci. Il s'agit d'un projet de test d'intrusion visant à automatiser les premières étapes d'un test d'intrusion qui vous permet d'automatiser les premières étapes d'un test d'intrusion : reconnaissance, énumération et numérisation. Cette toolbox inclut également un complément OSINT qui vous aide à collecter des informations sur votre cible.Ce projet est conçu pour nous aider à mieux comprendre les principes de base de la cybersécurité et à développer nos compétences en matière de test d'intrusion et d'automatisation.



## Table des matières

- Introduction
- Avant Utilisation
- Lancement de la ToolBox
- Récupération des CVE
- Interaction avec MITRE ATT&CK


## Introduction

Nous faisons partie d’un SOC en tant qu’Analyste redteam, il nous est demandé de réaliser l’automatisation d’action que nous réalisons tous les jours afin de gagner du temps sur nos tâches journalières. Nous avons donc mit en place différentes fonctions comme la recherche de CVE, le scan réseau et autre.


## Avant Utilisation

Avant de pouvoir lancer la ToolBox, il est important d'effectuer quelques actions sans quoi vous aurez des erreurs.

Installez les modules :
```bash
python3 -m pip install -r requirements.txt
```

Installez le logiciel wkhtmltopdf (nécessaire pour le bon fonctionnement de pdfkit) :
```bash
sudo apt install wkhtmltopdf
```

Pour retrouver les rapports générés par les différentes fonctions, tous les rapports sont stockés dans le dossier 'reports' qui sera créé au moment de la génération s'il n'existe pas


## Lancement de la ToolBox
Un avertissement d'utilisation de cette outil pour informer les utilisateurs potentiels sur les risques associés à l'utilisation de cet outil.Cela va aider à assurer la responsabilité des utilisateurs dans l'utilisation de l'outil de test d'intrusion, ainsi qu'à protéger les systèmes cibles, les données et les personnes contre les conséquences néfastes de l'utilisation abusive de l'outil.

![menu screen](files/img/Conditions.png)

Pour lancer la ToolBox, il suffit de rentrer dans un terminal `python3 main.py` ou `./main.py`, cela vous amènera sur le menu suivant qui vous permettra de choisir la fonction à exécuter, penser à accepter les conditions avant utilisation :
![menu screen](files/img/Menu.png)


Vous pourrez ensuite choisir quelle fonction utiliser en fonction du chiffre que vous rentrez




## Les 4 étapes d'intrusion

### [1] Menu Reconaissance 

Le menu de reconnaissance est un outil qui offre un large éventail d'options pour la recherche d'informations sur des cibles potentielles. Le menu est composé de 14 options, chacune offrant une fonctionnalité unique.

Le menu de reconnaissance s'ouvre sur une interface graphique simple et facile à utiliser, qui présente une série d'options numérotées allant de 1 à 14. 

Les options de menu comprennent une variété d'outils de recherche, tels que le Subdomain Hunter, l'Ip_addresses Hunter, le Port Hunter, Google Hunting, Windwos Hunting, search term -Shodan, search ip address - Shodan, find email using domain, find email using name&domain, validate email, author finder, et display description.

-Le Subdomain Hunter, l'Ip_addresses Hunter et le Port Hunter sont des outils qui permettent de trouver des informations sur les domaines, les adresses IP et les ports des cibles potentielles. 

-Google Hunting est un outil qui permet de rechercher des informations sur les cibles potentielles en utilisant le moteur de recherche Google.

-Windwos Hunting permet de trouver des informations sur les systèmes d'exploitation Windows.

-Les outils search term -Shodan et search ip address - Shodan permettent de rechercher des informations sur les cibles potentielles en utilisant le moteur de recherche Shodan.

-Les outils find email using domain et find email using name&domain permettent de trouver des adresses e-mail associées à une cible. L'outil validate email permet de vérifier la validité d'une adresse e-mail.

-L'outil author finder permet de trouver des informations sur l'auteur d'un site web. L'option display description permet d'afficher une brève description de chaque outil, et l'option back to main MENU permet de revenir au menu principal.

-L'option Exit permet de quitter l'application.

### [2] Menu Enumeration

Le menu présenté propose différentes options pour l'analyse de services et de données sur une adresse IP donnée :

-Service Enumeration : Cette option permet d'identifier les services en cours d'exécution sur l'adresse IP cible. Cela peut être utile pour trouver des vulnérabilités connues sur ces services.

-Service Enumeration v2 : Similaire à la première, mais utilise une méthode différente pour identifier les services. Il peut être utile de l'utiliser si la première option ne donne pas de résultats satisfaisants.

-Service Detection : Détecter les services en cours d'exécution sur l'adresse IP cible en utilisant une méthode différente de celle utilisée dans les deux premières options.

-Banner Grabbing : Obtenir des informations sur les services en cours d'exécution sur l'adresse IP cible, telles que la version du logiciel utilisé.

-Whois Lookup : Cette option permet d'obtenir des informations sur le propriétaire du domaine associé à l'adresse IP cible.

-HTTP Header Analysis : Analyser les en-têtes HTTP renvoyés par le serveur Web sur l'adresse IP cible. Cela peut aider à identifier les technologies utilisées par le serveur.

-IP Geolocation : Localiser approximativement l'adresse IP cible sur une carte en utilisant des données de géolocalisation.

-brief description options : Cette option fournit une description brève de chaque option disponible dans le menu.

-back to main MENU : Permet de revenir au menu principal.

-Exit : Cette option permet de quitter le programme.

### [3] Menu OSINT

Le menu présenté propose plusieurs options pour effectuer une extraction d'informations à partir d'une source donnée. Voici une description de chaque option :

-Link extractor : Extraire tous les liens présents sur une page Web donnée. Cela peut être utile pour obtenir une liste de tous les sites Web liés à une page donnée.

-Phones extractor : Extraire tous les numéros de téléphone présents sur une page Web donnée. Cela peut être utile pour collecter des numéros de téléphone pour des campagnes de marketing ou de télémarketing.

-Advanced extraction : Extraire des informations plus avancées à partir d'une page Web donnée, telles que les adresses e-mail, les noms d'utilisateurs, les mots de passe, etc. Cette option peut être utile pour récupérer des informations sensibles.

-Advanced_V2 osint : Utilise des techniques avancées d'open source intelligence (OSINT) pour collecter des informations sur une cible donnée, telles que les réseaux sociaux, les blogs, les forums, etc.

-Descriptions options : Cette option fournit une brève description de chaque option disponible dans le menu.

-back to main MENU : Cette option permet de revenir au menu principal.

-Exit : Cette option permet de quitter le programme.


### [4] Menu SCANNING


Le menu proposé présente plusieurs options pour scanner un hôte ou une adresse IP. Voici une description de chaque option :

-Host Discovery : Permet de détecter les hôtes actifs sur un réseau en utilisant différentes techniques de détection, telles que le ping et les requêtes ARP. Cette étape est importante avant de lancer un scan de vulnérabilité sur un réseau.

-Basic Scan : Cette option effectue un scan de port sur l'hôte cible pour détecter les ports ouverts et les services en cours d'exécution. Cette option est utile pour une analyse rapide de l'hôte.

-Advanced Scan : Effectue une analyse plus avancée de l'hôte cible, en utilisant différentes techniques pour détecter les vulnérabilités potentielles sur les services et les applications en cours d'exécution. Cette option peut prendre plus de temps que la première option.

-Os Detection : Permet de détecter le système d'exploitation en cours d'exécution sur l'hôte cible. Cette information peut être utile pour des tests d'intrusion ultérieurs.

-Back to the main menu : Permet de revenir au menu principal.


## Récupération des CVE

Après avoir effectué un scan NMAP d'une ou plusieurs machines, vous souhaitez récupérer une liste des CVE d'un ou plusieurs services tournant sur ces machines. Avec cette fonction, il est possible de rechercher des CVE listées sur le site [CVE mitre](https://cve.mitre.org/) en fournissant le nom exact du logiciel avec la possibilité ou non de précisé la version souhaitée si elle est connue.

exemple avec proftpd 1.3.1 :
![cve scrapper](files/img/cve_scrapper.PNG)

rapport généré :
![rapport CVE proftpd 1.3.1](files/img/rapport_cve.PNG)

Pour récupérer la liste des CVE, cette fonction utilise le module BeautifulSoup de python, c'est un module qui permet de scrapper une page web en fonction des tag, id, class et autres paramètres des balises. en effectuant une requête GET au site `cve.mitre.org/cgi-bin/cvekey.cgi?keyword=` tout en ajoutant en paramètres derrière 'keyword' le nom du logiciel + la version, tout cela permet de récupérer la page contant la liste des CVE demandées, grâce à BeautifulSoup nous scrappons cette page afin de ne récupérer que les CVE donc l'ID de la CVE ainsi que sa description que nous mettons ensuite dans une page html afin de soit générer le rapport en html soit convertir celui-ci en pdf avec pdfkit


## Interaction avec MITRE ATT&CK

Le framework MITRE ATT&CK est un framework créé par la société MITRE. C'est une base de connaissance qui répertorie les tactiques et les techniques utilisées par les groupes de cybercriminels. Cela permet donc de se tenir au courant des nouvelles techniques utilisées par les cybercriminels

Afin de pouvoir interagir avec le framework MITRE ATT&CK nous utilisons le module python [attackcti](https://attackcti.com/intro.html) qui est un module qui a été développé spécialement pour interagir avec ce framework et récupérer différentes informations

Utilisation de la fonction :
![menu fonction MITRE](files/img/mitre_menu.PNG)

Nous avons plusieurs fonction de disponibles avec cette fonction :

1. **Récupération de toutes les techniques :** Permet de récupérer la liste de toutes les techniques utilisées par tous les groupes

2. **Récupération de tous les groupes :** Permet de récupérer la liste complète des groupes de cybercriminels

2. **Récupération de tous les logiciels :** Permet de récupérer la liste complète de tous les logiciels

4. **Récupérations des techniques des groupes :** Permet de récupérer toutes les techniques utilisées par un groupe précis  
Exemple avec LAPSUS$  
![Screenshot MITRE LAPSUS Tech](files/img/mitre_lapsus_1.PNG)
![Rapport des techniques utilisées par LAPSUS](files/img/mitre_lapsus_2.PNG)

5. **Récupération des logiciels par groupe:** Permet de récupérer les logiciels utilisés ou attaqués par un groupe  
Exemple avec LAPSUS$  
![Screenshot MITRE LAPSUS Soft](files/img/mitre_lapsus_3.PNG)
![Rapport des logiciels en rapport avec LAPSUS$](files/img/mitre_lapsus_4.PNG)


## Récupération login et mot de passe par défaut

Lorsque vous trouvez des services en lignes, beaucoup demandes de se connectés, parfois les paramètres de ceux-ci peuvent restez ceux par défaut. Étant donné que tout les accès par défauts mis en place par les constructeurs sont connus, il est possible de se connecter si jamais ils n'ont pas été modifiés. Avec ce modules vous pouvez lister les logins et mots passes de chaques constructeurs ou bien de les chercher en fonction du constructeur choisi.  
  
Récupération de tous les logins et mots de passe :  
![choix de tous les logins](files/img/all_logins.PNG)  
  
Récupération avec choix du constructeur :  
![choix des logins d'un constructeur](files/img/logins_choice.PNG)
![rapports des logins](files/img/logins_reports.PNG)


## Récupérer les dossiers ou fichiers d'une page web

Sur une page web, il est possible qu'il se cache des dossiers ou des fichiers, ce module vous permet de récupérer ceux-ci grâce à des requêtes GET effectuées sur l'URL spécifiée en utilisant des mots clef présents dans les wordlists situées dans `files/wordlists`, vous pourrez choisir la wordlist que vous souhaitez, en fonction du choix les résultats ne seront pas forcément les même.  

Par exemple si vous avez un site de ce genre où vous souhaitez trouver des documents intéressants ou bien tout simplement non indexé :  
![un super site](files/img/site.PNG)
  
Récupération des dossiers :  
![choix de l'url](files/img/url_check_dir_1.PNG)
![rapports des dossiers](files/img/url_check_dir_2.PNG)

Récupération des fichiers avec par exemple html, pdf et txt : 
![choix de l'url](files/img/url_check_file_1.PNG)
![rapport des fichiers](files/img/url_check_file_2.PNG)


## Licence

Ce projet est sous licence [GPL-3.0](https://choosealicense.com/licenses/gpl-3.0/)
