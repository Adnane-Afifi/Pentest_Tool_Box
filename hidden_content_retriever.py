import colorama
import requests
import traceback
import os


def GetHiddenContent():
    url = input("Quelle est l'url que vous souhaitez tester ? : ")
    # liste les fichiers dans le dossier wordlists
    wordlistsFiles = os.listdir("files/wordlists")
    # liste vide qui contiendra les noms des wordlists
    wordlistsList = []
    print("wordlists utilisables :\n")
    # boucle ajoutant le contenu du dossier wordlists dans la liste
    for wordlist in wordlistsFiles:
        wordlistsList.append(wordlist)
    # parcours la liste pour afficher les wordlists disponibles
    for i in range(0, len(wordlistsList), 1):
        print(f"\t{i + 1}. {wordlistsList[i]}")
    # choix de la wordlist à utiliser
    try:
        index = int(input("\nQuel numéro de wordlist utiliser ? : ")) - 1
        if 0 <= index < len(wordlistsList):
            wordlistUsed = wordlistsList[index]
            with open(f"files/wordlists/{wordlistUsed}", 'r') as f:
                content = f.readlines()
                for keyword in content:
                    # supprime les retours à la ligne lors de la lecture du fichier
                    keyword = keyword.strip()
                    req = requests.get(url + keyword)
                    if req.status_code != 404:
                        print(f"{url}{keyword} : {req.status_code}")
        else:
            print(colorama.Fore.RED + "Veuillez choisir un des chiffres proposé" + colorama.Style.RESET_ALL)
    except Exception as e:
        print(colorama.Fore.RED + "il y a eu une erreur qui est : " + colorama.Style.RESET_ALL)
        traceback.print_exc()


def main():
    GetHiddenContent()


if __name__ == '__main__':
    main()
