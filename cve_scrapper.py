#!/usr/bin/env python3

from bs4 import BeautifulSoup
import colorama
import requests


def SearchExploit():
    buf = ''
    product = input("Nom du produit que vous cherchez : ")
    version = input("Version du produit (laisser vide si inconnue) : ")
    url = f"https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword={product}+{version}"
    headers = {'User-Agent': 'Mozilla/5.0 (compatible; MSIE 11.0; Windows NT 5.0; Trident/5.0)'}
    try:
        req = requests.get(url, headers=headers)
        soup = BeautifulSoup(req.content, "html.parser")
        divTag = soup.findAll('div', id='TableWithRules')
        for tag in divTag:
            divTag = tag.findAll('td', {'valign': 'top'})
            for i in divTag:
                buf += f"{i.text}#"
                temp = str(buf).replace('\n', '')
                exploitTable = temp.split('#')
        for j in range(0, len(exploitTable) - 1, 2):
            print(colorama.Fore.GREEN + f"{exploitTable[j]}" + colorama.Style.RESET_ALL + f" : {exploitTable[j+1]}")
    except Exception as e:
        print(colorama.Fore.RED + f"Il y a eu une erreur qui est : {e}" + colorama.Style.RESET_ALL)


def main():
    SearchExploit()


if __name__ == '__main__':
    main()
