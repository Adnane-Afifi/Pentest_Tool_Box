#!/usr/bin/env python3

from bs4 import BeautifulSoup
import colorama
import requests


def SearchExploit():
    product = input("Nom du produit que vous cherchez : ")
    version = input("Version du produit (laisser vide si inconnue) : ")
    url = f"https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword={product}+{version}"
    headers = {'User-Agent': 'Mozilla/5.0 (compatible; MSIE 11.0; Windows NT 5.0; Trident/5.0)'}
    try:
        req = requests.get(url, headers=headers)
        soup = BeautifulSoup(req.content, "html.parser")
        divTab = soup.findAll('div', id='TableWithRules')
        for tag in divTab:
            divTab = tag.findAll('td', {'valign': 'top'})
            exploitTable = divTab
        return exploitTable
    except Exception as e:
        print(e)


def main():
    ret = SearchExploit()
    print(ret)


if __name__ == '__main__':
    main()
