#!/usr/bin/env /usr/bin/python3

import cve_scrapper
import mitre
import logins
import hidden_url_content
import colorama


def main():

    while True:
        try:
            print("""
            \033[1m\033[32m
        █   █   █   █   █   █   █   █   █   █   █
        01010101010101010101010101010101010101010
        ╔═══════════════════════════════════════╗
                    POST-EXPLOITATION
        ╚═══════════════════════════════════════╝
        01010101010101010101010101010101010101010
        █   █   █   █   █   █   █   █   █   █   █
     \033[0m
        ___________________________________________
        |             █   █   █  █                 |
        |         M E N U    O P T I O N S         |
        |             █   █   █  █                 |
        |      [1] - CVE research                  |
        |      [2] - Use of MITRE ATT&CK           |
        |      [3] - search default credantials    |
        |      [4] - gobuster of websites          |
        |                                          |
        |      [Q] - QUIT                          |                                  
        |__________________________________________|
        """)
            choice = input("Quel est votre choix : ")

            if choice == '1':
                cve_scrapper.SearchExploit()
            elif choice == '2':
                UseMitre()
            elif choice == '3':
                UseLogins()
            elif choice == '4':
                hidden_url_content.GetHiddenContent()
            elif choice.upper() == 'Q':
                print(colorama.Fore.YELLOW + "Fin du programme" + colorama.Style.RESET_ALL)
                break
            else:
                print(colorama.Fore.YELLOW + "Veuillez choisir un des chiffres proposés !" + colorama.Style.RESET_ALL)
                continue

        except KeyboardInterrupt:
            print(colorama.Fore.YELLOW + "Fin du programme" + colorama.Style.RESET_ALL)
            break


def UseMitre():
    print("""
    1. Récupérer toutes les techniques
    2. Récupérer tous les groupes
    3. Récupérer tous les logiciels
    4. Récupérer les techniques utilsées par un groupe
    5. Récupérer les logiciels utilisés par un groupe
    """)
    choice = input("Votre choix : ")

    if choice == '1':
        mitre.GetAllTechniques()
    elif choice == '2':
        mitre.GetAllGroups()
    elif choice == '3':
        mitre.GetAllSoftwares()
    elif choice == '4':
        mitre.GetGroupsTechniques()
    elif choice == '5':
        mitre.GetGroupsSoftwares()
    else:
        print(colorama.Fore.YELLOW + "Veuillez choisir un des choix proposés" + colorama.Style.RESET_ALL)


def UseLogins():
    print("""
    1. Récupérer tous les logins par défaut
    2. Récupérer les logins par défaut en fonction du constructeur
    """)

    choice = input("Votre choix : ")

    if choice == '1':
        logins.GetAllCreds()
    elif choice == '2':
        logins.SearchCreds()
    else:
        print(colorama.Fore.YELLOW + "Veuillez choisir un des choix proposés" + colorama.Style.RESET_ALL)


if __name__ == '__main__':
    main()