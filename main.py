import cve_scrapper
import mitre
import logins
import hidden_url_content
import colorama


def main():

    print("""
___________________   ________  .____   __________ ________  ____  ___  
\__    ___/\_____  \  \_____  \ |    |  \______   \\_____  \ \   \/  /  
  |    |    /   |   \  /   |   \|    |   |    |  _/ /   |   \ \     /   
  |    |   /    |    \/    |    \    |___|    |   \/    |    \/     \   
  |____|   \_______  /\_______  /_______ \______  /\_______  /___/\  \  
                   \/         \/        \/      \/         \/      \_/ 
By Adnane AFIFI & Romain JOLLY
    """)

    while True:
        try:
            print("""
        Fonctions disponibles :
        
            1. Recherche de CVE
            2. Utilisation de MITRE ATT&CK
            3. Recherche des logins et mots de passes par défauts
            4. Recherche de dossiers/fichiers sur un site
            
            Q. Quitter le programme
        """)

            choice = input("Quel est votre choix : ")

            if choice == '1':
                cve_scrapper.SearchExploit()
            elif choice == '2':
                UseMitre()
            elif choice == '3':
                UseLogins()
            elif choice == '4':
                hidden_url_content.GetHiddenContent()
            elif choice.upper() == 'Q':
                print(colorama.Fore.YELLOW + "Fin du programme" + colorama.Style.RESET_ALL)
                break
            else:
                print(colorama.Fore.YELLOW + "Veuillez choisir un des chiffres proposés !" + colorama.Style.RESET_ALL)
                continue

        except KeyboardInterrupt:
            print(colorama.Fore.YELLOW + "Fin du programme" + colorama.Style.RESET_ALL)
            break


def UseMitre():
    print("""
    1. Récupérer toutes les techniques
    2. Récupérer tous les groupes
    3. Récupérer tous les logiciels
    4. Récupérer les techniques utilsées par un groupe
    5. Récupérer les logiciels utilisés par un groupe
    """)
    choice = input("Votre choix : ")

    if choice == '1':
        mitre.GetAllTechniques()
    elif choice == '2':
        mitre.GetAllGroups()
    elif choice == '3':
        mitre.GetAllSoftwares()
    elif choice == '4':
        mitre.GetGroupsTechniques()
    elif choice == '5':
        mitre.GetGroupsSoftwares()
    else:
        print(colorama.Fore.YELLOW + "Veuillez choisir un des choix proposés" + colorama.Style.RESET_ALL)


def UseLogins():
    print("""
    1. Récupérer tous les logins par défaut
    2. Récupérer les logins par défaut en fonction du constructeur
    """)

    choice = input("Votre choix : ")

    if choice == '1':
        logins.GetAllCreds()
    elif choice == '5':
        logins.SearchCreds()
    else:
        print(colorama.Fore.YELLOW + "Veuillez choisir un des choix proposés" + colorama.Style.RESET_ALL)


if __name__ == '__main__':
    main()