import attackcti
import pandas
import json

import logging
logging.getLogger('taxii2client').setLevel(logging.CRITICAL)

def GetAllTechniques():
    lift = attackcti.attack_client()
    techniques = lift.get_techniques()
    print(f"Number of techniques in ATT&CK : {len(techniques)}")
    all_techniques = []
    for t in techniques:
        all_techniques.append(json.loads(t.serialize()))
    df = pandas.json_normalize(all_techniques)
    #print(list(df))
    print(f"{techniques[0].name} : {techniques[0].description}")


def main():
    GetAllTechniques()


if __name__ == '__main__':
    main()