import subprocess
import sys


def search_information(domain_or_ip):
    INFORMATION_TYPES = ['email', 'subdomains']
    SEARCH_ENGINES = ['google', 'bing', 'yahoo']
    results = []
    try:
        import theHarvester
    except ImportError:
        print("Harvester isn't installed.Try to install it ....")
        subprocess.run(['pip', 'install', 'theHarvester'])
    for search_engine in SEARCH_ENGINES:
        for information_type in INFORMATION_TYPES:
            command = ['theHarvester', '-d', domain_or_ip, '-b', '-e', INFORMATION_TYPES]
            output = subprocess.run(command, capture_output=True).stdout.decode()
            results.append((search_engine, information_type, output))

        html = format_results(results, f"RÃ©sultats de la recherche sur {domain_or_ip}")
        print(html)


def format_results(results, title):
    html = "<html><head><title>{title}</title></head><body>"
    html += "<h1>{title}</h1>"
    html += "<table>"
    for search_engine, information_type, output in results:
        html += f"<tr><th>{search_engine} ({information_type})</th></tr>"
        html += f"<tr><td>{output}</td></tr>"
    html += "</table>"
    html += "</body></html>"
    return html
